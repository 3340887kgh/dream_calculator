<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>은퇴 후 자산 계산기</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      line-height: 1.6;
      max-width: 600px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: inline-block;
      width: 120px;
    }
    input[type="number"] {
      width: 150px;
      padding: 5px;
    }
    .result {
      margin-top: 20px;
      font-weight: bold;
      font-size: 1.2em;
    }
  </style>
</head>
<body>

  <h1>은퇴 후 자산 계산기</h1>
  <p>아래 값을 입력하면, 은퇴 후 예상 자산이 즉시 계산됩니다.</p>

  <!-- 보유 자산 -->
  <div class="form-group">
    <label for="B36">보유 자산(원):</label>
    <input type="number" id="B36" placeholder="예: 100000000" />
  </div>

  <!-- 연간 저축 금액 -->
  <div class="form-group">
    <label for="B37">연간 저축 금액(원):</label>
    <input type="number" id="B37" placeholder="예: 12000000" />
  </div>

  <!-- 투자·저축 기간(N년) -->
  <div class="form-group">
    <label for="B38">기간(N년):</label>
    <input type="number" id="B38" placeholder="예: 25" />
  </div>

  <!-- 명목 수익률 -->
  <div class="form-group">
    <label for="B39">명목 수익률(%):</label>
    <input type="number" id="B39" placeholder="예: 5" step="0.1" />
  </div>

  <!-- 저축 증가율 -->
  <div class="form-group">
    <label for="B40">저축 증가율(%):</label>
    <input type="number" id="B40" placeholder="예: 3" step="0.1" />
  </div>

  <!-- 계산 결과 -->
  <div class="result">
    은퇴 후 자산: <span id="resultValue">0</span> 원
  </div>

  <!-- 계산 스크립트 -->
  <script>
    // 실시간으로 입력받아 계산하기 위해, 모든 input에 'input' 이벤트를 걸어줍니다.
    document.querySelectorAll('input').forEach(el => {
      el.addEventListener('input', calculateRetirementAsset);
    });

    function calculateRetirementAsset() {
      // HTML의 각 입력값을 가져오기
      const B36 = parseFloat(document.getElementById('B36').value) || 0;  // 보유 자산
      const B37 = parseFloat(document.getElementById('B37').value) || 0;  // 연간 저축 금액
      const B38 = parseInt(document.getElementById('B38').value) || 0;    // N년
      const B39 = parseFloat(document.getElementById('B39').value) || 0;  // 명목 수익률(%)
      const B40 = parseFloat(document.getElementById('B40').value) || 0;  // 저축 증가율(%)

      // 퍼센트를 소수로 변환 (예: 5% -> 0.05)
      const nominalRate = B39 / 100;
      const savingGrowthRate = B40 / 100;

      // Excel에서 사용했던 공식
      // = IF(
      //   B39 = B40,
      //   B36 * (1 + B39)^B38 + B37 * B38 * (1 + B39)^(B38 - 1),
      //   B36 * (1 + B39)^B38 + B37 * (
      //       ((1 + B39)^B38 - (1 + B40)^B38)
      //       / (B39 - B40)
      //     )
      // )
      let result = 0;

      if (nominalRate === savingGrowthRate) {
        // B39 = B40 인 경우
        result = B36 * Math.pow(1 + nominalRate, B38)
               + B37 * B38 * Math.pow(1 + nominalRate, B38 - 1);
      } else {
        // B39 != B40 인 경우
        result = B36 * Math.pow(1 + nominalRate, B38)
               + B37 * (
                   ( Math.pow(1 + nominalRate, B38) - Math.pow(1 + savingGrowthRate, B38) )
                   / (nominalRate - savingGrowthRate)
                 );
      }

      // 결과 표시 (3자리 단위로 콤마)
      document.getElementById('resultValue').textContent = Math.round(result).toLocaleString();
    }
  </script>
</body>
</html>
